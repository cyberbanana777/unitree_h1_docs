## üß© –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫?

- **–ü—É–±–ª–∏–∫–∞—Ç–æ—Ä (Publisher)** ‚Äî —ç—Ç–æ —É–∑–µ–ª (node), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é **—Ç–µ–º—É (topic)**.
- **–ü–æ–¥–ø–∏—Å—á–∏–∫ (Subscriber)** ‚Äî —ç—Ç–æ —É–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π **—Å–ª—É—à–∞–µ—Ç** –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ç–µ–º—É –∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç—É–¥–∞ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–π ROS 2 –ø–∞–∫–µ—Ç:

```bash
ros2 pkg create --build-type ament_python my_py_pubsub
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `my_py_pubsub` —Å –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π Python-–ø–∞–∫–µ—Ç–∞ ROS 2.

–ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ `my_py_pubsub/my_py_pubsub/`:

- `publisher_member_function.py`
- `subscriber_member_function.py`

---

## üì§ 1. –ü—É–±–ª–∏–∫–∞—Ç–æ—Ä (Publisher)

### üîß –ö–æ–¥: `publisher_member_function.py`

```python
import rclpy                    # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ROS 2 –¥–ª—è Python
from rclpy.node import Node     # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–æ–≤
from std_msgs.msg import String # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è String –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

class MinimalPublisher(Node):   # –°–æ–∑–¥–∞—ë–º –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É–µ–º—ã–π –æ—Ç Node

    def __init__(self):
        super().__init__('minimal_publisher')  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–∑–µ–ª —Å –∏–º–µ–Ω–µ–º 'minimal_publisher'
        self.publisher_ = self.create_publisher(String, 'topic', 10)  # –°–æ–∑–¥–∞—ë–º –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä
        timer_period = 0.5  # —Å–µ–∫—É–Ω–¥—ã
        self.timer = self.create_timer(timer_period, self.timer_callback)  # –¢–∞–π–º–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç callback –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫
        self.i = 0  # –°—á—ë—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

    def timer_callback(self):
        msg = String()                     # –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–ø–∞ String
        msg.data = f'Hello World: {self.i}'  # –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ data
        self.publisher_.publish(msg)       # –ü—É–±–ª–∏–∫—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        self.get_logger().info(f'Publishing: "{msg.data}"')  # –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å (–ª–æ–≥)
        self.i += 1                        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫

def main(args=None):
    rclpy.init(args=args)               # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ROS 2
    minimal_publisher = MinimalPublisher()  # –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–≥–æ —É–∑–ª–∞
    rclpy.spin(minimal_publisher)       # –ó–∞–ø—É—Å–∫–∞–µ–º "—Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏" —É–∑–ª–∞
    minimal_publisher.destroy_node()    # –û—á–∏—â–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã
    rclpy.shutdown()                    # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É ROS 2

if __name__ == '__main__':
    main()
```

### üîç –ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º:

| –°—Ç—Ä–æ–∫–∞ | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|--------|------------|
| `import rclpy` | –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É ROS 2 –¥–ª—è Python. |
| `from rclpy.node import Node` | –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —É–∑–ª–∞. |
| `from std_msgs.msg import String` | –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî —Å—Ç—Ä–æ–∫—É. |
| `class MinimalPublisher(Node):` | –ù–∞—à —É–∑–µ–ª –±—É–¥–µ—Ç –∫–ª–∞—Å—Å–æ–º, —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–º –æ—Ç `Node`. |
| `super().__init__('minimal_publisher')` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–∑–µ–ª —Å –∏–º–µ–Ω–µ–º `minimal_publisher` (—ç—Ç–æ –∏–º—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –≤ —Å–∏—Å—Ç–µ–º–µ). |
| `self.create_publisher(String, 'topic', 10)` | –°–æ–∑–¥–∞—ë–º –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä: —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è, –∏–º—è —Ç–µ–º—ã (`topic`), —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ (10 —Å–æ–æ–±—â–µ–Ω–∏–π). |
| `self.create_timer(...)` | –°–æ–∑–¥–∞—ë–º —Ç–∞–π–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫ –≤—ã–∑—ã–≤–∞–µ—Ç `timer_callback`. |
| `msg = String()` | –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. |
| `msg.data = ...` | –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è. |
| `self.publisher_.publish(msg)` | –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ–º—É. |
| `self.get_logger().info(...)` | –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–∫–∞–∫ `print`, –Ω–æ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º ROS). |
| `rclpy.spin(...)` | –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è. |

---

## üì• 2. –ü–æ–¥–ø–∏—Å—á–∏–∫ (Subscriber)

### üîß –ö–æ–¥: `subscriber_member_function.py`

```python
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class MinimalSubscriber(Node):

    def __init__(self):
        super().__init__('minimal_subscriber')
        self.subscription = self.create_subscription(
            String,           # –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
            'topic',          # –ò–º—è —Ç–µ–º—ã (–¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä–æ–º!)
            self.listener_callback,  # –§—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
            10)               # –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
        self.subscription  # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è"

    def listener_callback(self, msg):
        self.get_logger().info(f'I heard: "{msg.data}"')

def main(args=None):
    rclpy.init(args=args)
    minimal_subscriber = MinimalSubscriber()
    rclpy.spin(minimal_subscriber)
    minimal_subscriber.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
```

### üîç –ü–æ—è—Å–Ω–µ–Ω–∏–µ:

| –°—Ç—Ä–æ–∫–∞ | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|--------|------------|
| `self.create_subscription(...)` | –°–æ–∑–¥–∞—ë–º –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Ç–µ–º—É `topic` —Å —Ç–∏–ø–æ–º `String`. |
| `self.listener_callback` | –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. |
| `self.subscription` | –ü—Ä–æ—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, —á—Ç–æ–±—ã Python –Ω–µ —É–¥–∞–ª–∏–ª –µ—ë –∫–∞–∫ "–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é". |
| `listener_callback(self, msg)` | –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `msg` –∏ –≤—ã–≤–æ–¥–∏—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ. |

---


---

## (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!) –ø—Ä–æ–ø–∏—Å–∞—Ç—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ `setup.py`

- –í—Å–µ —É–∑–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **"–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã" –≤ `setup.py`**, —á—Ç–æ–±—ã `ros2 run` –∏—Ö –Ω–∞—Ö–æ–¥–∏–ª.

–ü—Ä–∏–º–µ—Ä `setup.py` (–≤ –∫–æ—Ä–Ω–µ –ø–∞–∫–µ—Ç–∞):

```python
from setuptools import setup

package_name = 'my_py_pubsub'

setup(
    name=package_name,
    version='0.0.0',
    packages=[package_name],
    data_files=[
        ('share/ament_index/resource_index/packages', ['resource/' + package_name]),
        ('share/' + package_name, ['package.xml']),
    ],
    install_requires=['setuptools'],
    zip_safe=True,
    entry_points={
        'console_scripts': [
            'talker = my_py_pubsub.publisher_member_function:main',
            'listener = my_py_pubsub.subscriber_member_function:main',
        ],
    },
)
```

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?

1. **–°–æ–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç** (–∏–∑ –∫–æ—Ä–Ω—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `~/ros2_ws`):

```bash
colcon build --packages-select my_py_pubsub
```

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:

```bash
source install/setup.bash
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä –≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**:

```bash
ros2 run my_py_pubsub talker
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–¥–ø–∏—Å—á–∏–∫ –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (–Ω–µ –∑–∞–±—É–¥—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≤–æ –≤—Ç–æ—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª)**:

```bash
ros2 run my_py_pubsub listener
```

–í—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—É–±–ª–∏–∫—É–µ—Ç –ø–µ—Ä–≤—ã–π —É–∑–µ–ª.
