# –û—Å–Ω–æ–≤—ã ROS2

## 1. –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–æ–±—â–µ–Ω–∏–∏ —Ç–æ–ø–∏–∫–∞
### 1. **–£–∑–Ω–∞—Ç—å —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ–ø–∏–∫–∞**

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å, –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–º —Ç–æ–ø–∏–∫–µ:

```bash
ros2 topic info /–∏–º—è_—Ç–æ–ø–∏–∫–∞
```

–ü—Ä–∏–º–µ—Ä:

```bash
ros2 topic info /scan
```

def main(args=None):
    rclpy.init(args=args)
–í—ã–≤–æ–¥ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∏–º:

```
Type: sensor_msgs/msg/LaserScan
Publishers: 1
Subscribers: 0
```

–ó–¥–µ—Å—å —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî `sensor_msgs/msg/LaserScan`.

---

### 2. **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –µ–≥–æ —Ç–∏–ø—É**

–¢–µ–ø–µ—Ä—å, –∑–Ω–∞—è —Ç–∏–ø, –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:

```bash
ros2 interface show <—Ç–∏–ø_—Å–æ–æ–±—â–µ–Ω–∏—è>
```

–ü—Ä–∏–º–µ—Ä:

```bash
ros2 interface show sensor_msgs/msg/LaserScan
```

–≠—Ç–æ –≤—ã–≤–µ–¥–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –≤—Å–µ –ø–æ–ª—è, –∏—Ö —Ç–∏–ø—ã –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

---

### 3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è "–≤–∂–∏–≤—É—é"**

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ç–æ–ø–∏–∫–∞ (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
ros2 topic echo /–∏–º—è_—Ç–æ–ø–∏–∫–∞
```

–ü—Ä–∏–º–µ—Ä:

```bash
ros2 topic echo /scan
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ç–æ–ø–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

### –ö—Ä–∞—Ç–∫–æ:

1. `ros2 topic info /topic_name` ‚Üí —É–∑–Ω–∞—Ç—å —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è.
2. `ros2 interface show package/msg/MessageType` ‚Üí –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
3. `ros2 topic echo /topic_name` ‚Üí –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è.

---

–ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω–æ–µ –∏–º—è —Ç–æ–ø–∏–∫–∞, —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–ø–∏–∫–æ–≤:

```bash
ros2 topic list
```

---

## 2. –ö–∞–∫ –ø—Ä–∏–Ω—è—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–æ–ø–∏–∫–µ

### üîπ 1. **–ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `ros2 topic pub` (–≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)**

–≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
```bash
ros2 topic pub <—Ç–æ–ø–∏–∫> <—Ç–∏–ø_—Å–æ–æ–±—â–µ–Ω–∏—è> "<–∑–Ω–∞—á–µ–Ω–∏—è_–≤_yaml>"
```

### –ü—Ä–∏–º–µ—Ä: –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–ø–∞ `std_msgs/msg/String`
```bash
ros2 topic pub /chatter std_msgs/msg/String "data: 'Hello from terminal!'"
```

> üí° ROS 2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—É–±–ª–∏–∫—É–µ—Ç –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç —Ä–∞–±–æ—Ç—É. –ß—Ç–æ–±—ã –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å –∑–∞–¥–∞–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π, –¥–æ–±–∞–≤—å—Ç–µ —Ñ–ª–∞–≥ `-r` (rate):

```bash
ros2 topic pub -r 1 /chatter std_msgs/msg/String "data: 'Hello every second!'"
```
(–ø—É–±–ª–∏–∫—É–µ—Ç 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É)

---

### –ü—Ä–∏–º–µ—Ä: –ø—É–±–ª–∏–∫–∞—Ü–∏—è `geometry_msgs/msg/Twist` (—á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–±–æ—Ç–æ–º)
```bash
def main(args=None):
    rclpy.init(args=args)
ros2 topic pub /cmd_vel geometry_msgs/msg/Twist "linear:
  x: 0.5
  y: 0.0
  z: 0.0
angular:
  x: 0.0
  y: 0.0
  z: 0.2"
```

> ‚ö†Ô∏è –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ—Ç—Å—Ç—É–ø—ã ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **YAML-—Ñ–æ—Ä–º–∞—Ç**, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–±–µ–ª—ã –≤–∞–∂–Ω—ã!

---

### üîπ 2. **–ò–∑ Python-–Ω–æ–¥—ã (—Å –ø–æ–º–æ—â—å—é `rclpy`)**

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–¥:

```python
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class MinimalPublisher(Node):
    def __init__(self):
        super().__init__('minimal_publisher')
        self.publisher_ = self.create_publisher(String, 'chatter', 10)
        timer_period = 1.0  # —Å–µ–∫—É–Ω–¥—ã
        self.timer = self.create_timer(timer_period, self.timer_callback)

    def timer_callback(self):
        msg = String()
        msg.data = 'Hello from Python node!'
        self.publisher_.publish(msg)
        self.get_logger().info(f'Publishing: "{msg.data}"')

def main(args=None):
    rclpy.init(args=args)
    node = MinimalPublisher()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
```

–ó–∞–ø—É—Å–∫:
```bash
python3 publisher_example.py
```
---

## üß© –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫?

- **–ü—É–±–ª–∏–∫–∞—Ç–æ—Ä (Publisher)** ‚Äî —ç—Ç–æ —É–∑–µ–ª (node), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é **—Ç–µ–º—É (topic)**.
- **–ü–æ–¥–ø–∏—Å—á–∏–∫ (Subscriber)** ‚Äî —ç—Ç–æ —É–∑–µ–ª, –∫–æ—Ç–æ—Ä—ã–π **—Å–ª—É—à–∞–µ—Ç** –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ç–µ–º—É –∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç—É–¥–∞ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–π ROS 2 –ø–∞–∫–µ—Ç:

```bash
ros2 pkg create --build-type ament_python my_py_pubsub
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `my_py_pubsub` —Å –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π Python-–ø–∞–∫–µ—Ç–∞ ROS 2.
float32[3] rpy
int8 temperature

–ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ `my_py_pubsub/my_py_pubsub/`:

- `publisher_member_function.py`
- `subscriber_member_function.py`

---

## üì§ 1. –ü—É–±–ª–∏–∫–∞—Ç–æ—Ä (Publisher)

### üîß –ö–æ–¥: `publisher_member_function.py`

```python
import rclpy                    # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ROS 2 –¥–ª—è Python
from rclpy.node import Node     # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–æ–≤
from std_msgs.msg import String # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è String –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

class MinimalPublisher(Node):   # –°–æ–∑–¥–∞—ë–º –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É–µ–º—ã–π –æ—Ç Node

    def __init__(self):
        super().__init__('minimal_publisher')  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–∑–µ–ª —Å –∏–º–µ–Ω–µ–º 'minimal_publisher'
        self.publisher_ = self.create_publisher(String, 'topic', 10)  # –°–æ–∑–¥–∞—ë–º –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä
        timer_period = 0.5  # —Å–µ–∫—É–Ω–¥—ã
        self.timer = self.create_timer(timer_period, self.timer_callback)  # –¢–∞–π–º–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç callback –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫
        self.i = 0  # –°—á—ë—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

    def timer_callback(self):
        msg = String()                     # –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–ø–∞ String
        msg.data = f'Hello World: {self.i}'  # –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ data
        self.publisher_.publish(msg)       # –ü—É–±–ª–∏–∫—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        self.get_logger().info(f'Publishing: "{msg.data}"')  # –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å (–ª–æ–≥)
        self.i += 1                        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫

def main(args=None):
    rclpy.init(args=args)               # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ROS 2
    minimal_publisher = MinimalPublisher()  # –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–≥–æ —É–∑–ª–∞
    rclpy.spin(minimal_publisher)       # –ó–∞–ø—É—Å–∫–∞–µ–º "—Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏" —É–∑–ª–∞
    minimal_publisher.destroy_node()    # –û—á–∏—â–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã
    rclpy.shutdown()                    # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É ROS 2

if __name__ == '__main__':
    main()
```

### üîç –ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º:

| –°—Ç—Ä–æ–∫–∞ | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|--------|------------|
| `import rclpy` | –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É ROS 2 –¥–ª—è Python. |
| `from rclpy.node import Node` | –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —É–∑–ª–∞. |
| `from std_msgs.msg import String` | –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî —Å—Ç—Ä–æ–∫—É. |
| `class MinimalPublisher(Node):` | –ù–∞—à —É–∑–µ–ª –±—É–¥–µ—Ç –∫–ª–∞—Å—Å–æ–º, —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–º –æ—Ç `Node`. |
| `super().__init__('minimal_publisher')` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —É–∑–µ–ª —Å –∏–º–µ–Ω–µ–º `minimal_publisher` (—ç—Ç–æ –∏–º—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –≤ —Å–∏—Å—Ç–µ–º–µ). |
| `self.create_publisher(String, 'topic', 10)` | –°–æ–∑–¥–∞—ë–º –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä: —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è, –∏–º—è —Ç–µ–º—ã (`topic`), —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ (10 —Å–æ–æ–±—â–µ–Ω–∏–π). |
| `self.create_timer(...)` | –°–æ–∑–¥–∞—ë–º —Ç–∞–π–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫ –≤—ã–∑—ã–≤–∞–µ—Ç `timer_callback`. |
| `msg = String()` | –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. |
| `msg.data = ...` | –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è. |
| `self.publisher_.publish(msg)` | –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ–º—É. |
| `self.get_logger().info(...)` | –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–∫–∞–∫ `print`, –Ω–æ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º ROS). |
| `rclpy.spin(...)` | –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è. |

---

## üì• 2. –ü–æ–¥–ø–∏—Å—á–∏–∫ (Subscriber)

### üîß –ö–æ–¥: `subscriber_member_function.py`

```python
import rclpy
from rclpy.node import Node
from std_msgs.msg import String

class MinimalSubscriber(Node):

    def __init__(self):
        super().__init__('minimal_subscriber')
        self.subscription = self.create_subscription(
            String,           # –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
            'topic',          # –ò–º—è —Ç–µ–º—ã (–¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä–æ–º!)
            self.listener_callback,  # –§—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
            10)               # –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
        self.subscription  # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è"

    def listener_callback(self, msg):
        self.get_logger().info(f'I heard: "{msg.data}"')

def main(args=None):
    rclpy.init(args=args)
    minimal_subscriber = MinimalSubscriber()
    rclpy.spin(minimal_subscriber)
    minimal_subscriber.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
```

### üîç –ü–æ—è—Å–Ω–µ–Ω–∏–µ:

| –°—Ç—Ä–æ–∫–∞ | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|--------|------------|
| `self.create_subscription(...)` | –°–æ–∑–¥–∞—ë–º –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Ç–µ–º—É `topic` —Å —Ç–∏–ø–æ–º `String`. |
| `self.listener_callback` | –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. |
| `self.subscription` | –ü—Ä–æ—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, —á—Ç–æ–±—ã Python –Ω–µ —É–¥–∞–ª–∏–ª –µ—ë –∫–∞–∫ "–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é". |
| `listener_callback(self, msg)` | –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `msg` –∏ –≤—ã–≤–æ–¥–∏—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ. |

---

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?

1. **–°–æ–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç** (–∏–∑ –∫–æ—Ä–Ω—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `~/ros2_ws`):

```bash
colcon build --packages-select my_py_pubsub
```

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:

```bash
source install/setup.bash
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—É–±–ª–∏–∫–∞—Ç–æ—Ä –≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**:

```bash
ros2 run my_py_pubsub publisher_member_function
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–¥–ø–∏—Å—á–∏–∫ –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ**:

```bash
ros2 run my_py_pubsub subscriber_member_function
```

–í—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—É–±–ª–∏–∫—É–µ—Ç –ø–µ—Ä–≤—ã–π —É–∑–µ–ª.

---

## üí° –°–æ–≤–µ—Ç—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ **–∏–º–µ–Ω–∞ —Ç–µ–º —Å–æ–≤–ø–∞–¥–∞—é—Ç** (`'topic'` –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ).
- ROS 2 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É**, –Ω–æ `rclpy.spin()` –¥–µ–ª–∞–µ—Ç –≤—Å—ë "–ø—Ä–æ—Å—Ç–æ –∏ –ª–∏–Ω–µ–π–Ω–æ".
- –í—Å–µ —É–∑–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `setup.py`**, —á—Ç–æ–±—ã `ros2 run` –∏—Ö –Ω–∞—Ö–æ–¥–∏–ª.

–ü—Ä–∏–º–µ—Ä `setup.py` (–≤ –∫–æ—Ä–Ω–µ –ø–∞–∫–µ—Ç–∞):

```python
from setuptools import setup

package_name = 'my_py_pubsub'

setup(
    name=package_name,
    version='0.0.0',
    packages=[package_name],
    data_files=[
        ('share/ament_index/resource_index/packages', ['resource/' + package_name]),
        ('share/' + package_name, ['package.xml']),
    ],
    install_requires=['setuptools'],
    zip_safe=True,
    entry_points={
        'console_scripts': [
            'talker = my_py_pubsub.publisher_member_function:main',
            'listener = my_py_pubsub.subscriber_member_function:main',
        ],
    },
)
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ—Ä–æ—á–µ:

```bash
ros2 run my_py_pubsub talker
ros2 run my_py_pubsub listener
```

## ü§ñ –ß—Ç–æ —Ç–∞–∫–æ–µ `LowCmd` –∏ `LowState`?

- **`LowCmd`** ‚Äî —ç—Ç–æ **—Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Ä–æ–±–æ—Ç—É**.  
  ‚Üí –í—ã –≥–æ–≤–æ—Ä–∏—Ç–µ: ¬´–ú–æ—Ç–æ—Ä ‚Ññ3, –ø–æ–≤–µ—Ä–Ω–∏—Å—å –Ω–∞ 0.5 —Ä–∞–¥–∏–∞–Ω —Å —Ç–∞–∫–æ–π –∂—ë—Å—Ç–∫–æ—Å—Ç—å—é!¬ª

- **`LowState`** ‚Äî —ç—Ç–æ **–æ—Ç–≤–µ—Ç –æ—Ç —Ä–æ–±–æ—Ç–∞**, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç:  
  ‚Üí ¬´–í–æ—Ç –º–æ–∏ —Ç–µ–∫—É—â–∏–µ —É–≥–ª—ã, —Å–∫–æ—Ä–æ—Å—Ç–∏, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã, –¥–∞–Ω–Ω—ã–µ —Å –≥–∏—Ä–æ—Å–∫–æ–ø–∞ –∏ —Ç.–¥.¬ª

–≠—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ **–Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ (low-level)** ‚Äî –≤—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –º–æ—Ç–æ—Ä–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π –≤—Ä–æ–¥–µ ¬´–∏–¥—Ç–∏ –≤–ø–µ—Ä—ë–¥¬ª.

---

## üì§ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `LowCmd` ‚Äî –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∞

```plaintext
uint8[2] head                
uint8 level_flag              
uint8 frame_reserve          
uint32[2] sn                 
uint32[2] version            
uint16 bandwidth             
MotorCmd[20] motor_cmd       ‚Üí **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è 20 –º–æ—Ç–æ—Ä–æ–≤** (–≥–ª–∞–≤–Ω–æ–µ –ø–æ–ª–µ!)
BmsCmd bms_cmd               
uint8[40] wireless_remote    
uint8[12] led               
uint8[2] fan                 
uint8 gpio                 
uint32 reserve              
uint32 crc                   ‚Üí –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞
```

### üîß –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ `MotorCmd` (–æ–¥–∏–Ω –º–æ—Ç–æ—Ä)?

```plaintext
uint8 mode   
float32 q    ‚Üí –¶–µ–ª–µ–≤–æ–π —É–≥–æ–ª (–≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö). –ù–∞–ø—Ä–∏–º–µ—Ä: 0.0 = –Ω–µ–π—Ç—Ä–∞–ª—å, 1.0 ‚âà 57¬∞
float32 dq   ‚Üí –¶–µ–ª–µ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Ä–∞—â–µ–Ω–∏—è (—Ä–∞–¥/—Å). –û–±—ã—á–Ω–æ 0.
float32 tau  ‚Üí –¶–µ–ª–µ–≤–æ–π –º–æ–º–µ–Ω—Ç (–ù¬∑–º). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ 1.
float32 kp   ‚Üí "–ñ—ë—Å—Ç–∫–æ—Å—Ç—å" ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –º–æ—Ç–æ—Ä —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ—Ç—Å—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é –æ—Ç —É–≥–ª–∞ `q`
float32 kd   ‚Üí "–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è" ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –º–æ—Ç–æ—Ä —Ç–æ—Ä–º–æ–∑–∏—Ç –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏
uint32[3] reserve 
```

> üí° **–ü—Ä–∏–º–µ—Ä**:  
> –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –º–æ—Ç–æ—Ä –¥–µ—Ä–∂–∞–ª —É–≥–æ–ª 0.3 —Ä–∞–¥ –∏ –±—ã–ª "—É–ø—Ä—É–≥–∏–º", –∫–∞–∫ –ø—Ä—É–∂–∏–Ω–∞:  
> ```python
> mode = 10
> q = 0.3
> dq = 0.0
> kp = 50.0
> kd = 2.0
> ```

---

## üì• –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `LowState` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–æ–±–æ—Ç–∞

```plaintext
uint8[2] head                
uint8 level_flag             
uint8 frame_reserve          
uint32[2] sn                 
uint32[2] version            
uint16 bandwidth             
IMUState imu_state           ‚Üí **–î–∞–Ω–Ω—ã–µ —Å –≥–∏—Ä–æ—Å–∫–æ–ø–∞ –∏ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞**
MotorState[20] motor_state   ‚Üí **–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö 20 –º–æ—Ç–æ—Ä–æ–≤**
BmsState bms_state           
int16[4] foot_force          
int16[4] foot_force_est     
uint32 tick                  
uint8[40] wireless_remote    
uint8 bit_flag               
float32 adc_reel             
int8 temperature_ntc1/2      
float32 power_v              
float32 power_a              
uint16[4] fan_frequency      
uint32 reserve               
uint32 crc                   
```

### üìä –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ `MotorState` (–æ–¥–∏–Ω –º–æ—Ç–æ—Ä)?

```plaintext
uint8 mode        ‚Üí –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –º–æ—Ç–æ—Ä–∞
float32 q         ‚Üí –¢–µ–∫—É—â–∏–π —É–≥–æ–ª (—Ä–∞–¥)
float32 dq        ‚Üí –¢–µ–∫—É—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (—Ä–∞–¥/—Å)
float32 ddq       ‚Üí –£—Å–∫–æ—Ä–µ–Ω–∏–µ (—Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
float32 tau_est   ‚Üí –û—Ü–µ–Ω–∫–∞ –º–æ–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–µ–π—á–∞—Å –ø—Ä–∏–ª–æ–∂–µ–Ω
float32 q_raw     ‚Üí "–°—ã—Ä–æ–π" —É–≥–æ–ª (–¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
float32 dq_raw    ‚Üí "–°—ã—Ä–∞—è" —Å–∫–æ—Ä–æ—Å—Ç—å
int8 temperature  ‚Üí –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ—Ç–æ—Ä–∞ (¬∞C)
uint32 lost       ‚Üí –°–∫–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ—Ç–µ—Ä—è–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –º–æ—Ç–æ—Ä–∞
```

### üß≠ –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ `IMUState`?


```plaintext
float32 quaternion[4]   ‚Üí –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è —Ä–æ–±–æ—Ç–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ: [w, x, y, z]
float32 gyroscope[3]    ‚Üí –£–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: [œâx, œây, œâz] (—Ä–∞–¥/—Å)
float32 accelerometer[3]‚Üí –£—Å–∫–æ—Ä–µ–Ω–∏–µ: [ax, ay, az] (–º/—Å¬≤)
float32[3] rpy
int8 temperature

```
---

## üß© –ö–∞–∫ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? (–ö—Ä–∞—Ç–∫–æ)

- –ß—Ç–æ–±—ã **—É–ø—Ä–∞–≤–ª—è—Ç—å –º–æ—Ç–æ—Ä–∞–º–∏** ‚Üí –ø—É–±–ª–∏–∫—É–π—Ç–µ –≤ —Ç–æ–ø–∏–∫ `/lowcmd`, –∑–∞–ø–æ–ª–Ω—è—è `motor_cmd[i]`.
- –ß—Ç–æ–±—ã **—á–∏—Ç–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ** ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ `/lowstate`, —á–∏—Ç–∞–π—Ç–µ `motor_state[i].q`, `imu_state.gyroscope` –∏ —Ç.–¥.

---
